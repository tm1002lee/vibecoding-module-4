# log-gen: 트래픽 로그 생성 툴

무작위 트래픽 세션 로그를 생성하여 Backend API에 전송하는 Python 기반 테스트 툴입니다.

## 기능

- ✅ 무작위 트래픽 로그 생성 (TCP/UDP/ICMP)
- ✅ Backend API (`POST /api/logs`)로 자동 전송
- ✅ 생성된 로그 정보 실시간 출력
- ✅ 배치 생성 지원
- ✅ 데몬 모드 (주기적 생성)

## 설치

```bash
cd log-gen
pip install -r requirements.txt
```

## 사용법

### 1. 기본 사용 (10개 로그 생성)

```bash
python log_gen.py
```

### 2. 특정 개수 생성

```bash
python log_gen.py -n 100
```

### 3. 데몬 모드 (1초마다 10개씩 생성)

```bash
python log_gen.py -d -n 10 -i 1.0
```

### 4. 조용한 모드 (상세 출력 없음)

```bash
python log_gen.py -n 1000 -q
```

### 5. 커스텀 API URL

```bash
python log_gen.py --api-url http://192.168.1.100:8000/api -n 50
```

## 명령행 옵션

| 옵션 | 설명 | 기본값 |
|------|------|--------|
| `-n, --count` | 생성할 로그 개수 | 10 |
| `-d, --daemon` | 데몬 모드 활성화 | False |
| `-i, --interval` | 데몬 모드 배치 간격 (초) | 1.0 |
| `-q, --quiet` | 상세 출력 비활성화 | False |
| `--api-url` | Backend API URL | http://localhost:8000/api |

## 예제 출력

```
================================================================================
🔥 log-gen: 트래픽 로그 생성 툴
================================================================================
📊 10개의 로그 생성 중...

[1] TCP   | 192.168.1.101:34521 → 10.0.0.55:8080      | Packets:  542 | Bytes:  456789 | CPU: 3
[2] UDP   | 172.16.0.23:51234   → 8.8.8.8:53         | Packets:   12 | Bytes:    1024 | CPU: 1
[3] ICMP  | 10.10.10.10:45678   → 192.168.0.1:0      | Packets:    5 | Bytes:     320 | CPU: 0
...

✅ 완료: 10/10 로그 전송 성공
```

## 데몬 모드 예제

```bash
$ python log_gen.py -d -n 50 -i 2.0
🚀 데몬 모드 시작 (배치 크기: 50, 간격: 2.0초)
📡 Backend API: http://localhost:8000/api
종료하려면 Ctrl+C를 누르세요.

[2026-02-10 13:45:00] 배치 생성 중...
✅ 50/50 전송 완료 (0.52초) | 누적: 50/50

[2026-02-10 13:45:02] 배치 생성 중...
✅ 50/50 전송 완료 (0.51초) | 누적: 100/100
...
```

## 생성되는 로그 필드

- `protocol`: TCP, UDP, ICMP 중 랜덤 선택
- `src_ip`: 랜덤 IPv4 주소 (1-255.0-255.0-255.1-255)
- `src_port`: 랜덤 포트 (1024-65535)
- `dst_ip`: 랜덤 IPv4 주소
- `dst_port`: 랜덤 포트 (1024-65535)
- `packets`: 1-1000 범위의 랜덤 값
- `bytes`: packets × (64-1500) 범위의 랜덤 값
- `cpu_id`: 0-7 범위의 랜덤 CPU ID
- `timestamp`: 서버에서 자동 생성

## 주의사항

- Backend 서버가 실행 중이어야 합니다 (`http://localhost:8000`)
- 대량 생성 시 API 부하에 주의하세요
- 데몬 모드는 `Ctrl+C`로 종료할 수 있습니다

## logcollector C 데몬과의 차이

| 항목 | log-gen (Python) | logcollector (C) |
|------|------------------|------------------|
| 언어 | Python 3 | C |
| 빌드 | 불필요 | 컴파일 필요 |
| 데이터 소스 | 랜덤 생성 | 커널 모듈 연동 |
| 저장 방식 | API 전송 | SQLite 직접 저장 |
| 캐시 | 없음 | 메모리 캐시 |
| 용도 | 테스트/개발 | 프로덕션 |
